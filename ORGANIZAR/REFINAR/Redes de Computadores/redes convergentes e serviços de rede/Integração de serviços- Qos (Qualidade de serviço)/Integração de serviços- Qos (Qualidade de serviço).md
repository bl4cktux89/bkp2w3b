### Introdução

### O que é Qualidade de serviço ...

Estamos presenciando um crescimento exponencial do número de usuários de redes de computadores e, em consequência, um crescimento constante de novas aplicações geradoras de tráfego de diferentes naturezas (áudio, vídeo, aplicações em tempo real, etc). Muitas destas novas aplicações são exigentes quanto ao nível do atraso máximo no transporte dos dados, da variação máxima desse atraso (jitter), das perdas permitidas ou da largura de banda disponível.

Assim, para que se obtenha uma garantia de que as redes de computadores funcionem corretamente, é preciso aplicar tecnologias que permitam atingir um nível de tráfego satisfatório e confiável para dados e aplicações e que determinados níveis de desempenho sejam garantidos através de uma política capaz de estabelecer métricas e de caracterizar e descrever o comportamento da rede no que diz respeito a sua utilização e performance.

### Definindo QoS

Uma definição para Qualidade de Serviço (QoS) é dada pela recomendação I.350 do ITU-T, a partir da recomendação E.800, onde define-se a Qualidade de Serviço como sendo o efeito coletivo provocado pelas características de desempenho de um serviço, determinando o grau de satisfação do usuário, ou seja, a QoS pode ser definida como o conjunto de características de um sistema necessário para atingir uma determinada funcionalidade. Pode ser descrita ainda como um conjunto de parâmetros que descrevem a qualidade de um fluxo de dados específico, por exemplo, largura de banda, prioridades, etc.

O processo de definição de QoS para uma rede começa com o estabelecimento dos parâmetros exigidos pelos usuários. Esses parâmetros são mapeados e negociados entre os componentes da rede assegurando que todos podem atingir um nível de QoS aceitável. Posteriormente recursos são alocados e monitorados, havendo possibilidade de renegociação caso as condições do sistema se alterem.

### QoS definida pelo usuário

O usuário deve especificar requisitos de QoS definindo os níveis desejados de confiabilidade dos componentes da rede que serão observados em tempo de execução. Entretanto, o usuário normalmente não tem condições de especificar parâmetros de baixo nível, como largura de banda ou mesmo propriedades das mídias utilizadas como, por exemplo, frequência de amostragem para aplicações de

videoconferência. Assim, é necessário que o projeto forneça um certo nível de abstração para que o usuário possa definir o que ele considera aceitável para a satisfação de suas necessidades.

Podem ser criadas tabelas (a partir de testes) com faixas comparativas que estabelecem os níveis de qualidade possíveis para cada aplicação. A partir daí, o usuário poderá escolher um valor que atenda a qualidade desejada. Podem-se ainda apresentar exemplos de mídias antes da execução, de modo que ele possa escolher a amostra que apresenta as características desejáveis. O usuário ainda pode indicar uma opção que seja aceitável quando a primeira não estiver disponível.

### QoS em sistemas multimídia

A Qualidade de Serviço é um requisito básico das aplicações multimídia, uma vez que se exige que determinados parâmetros relativos a estas aplicações estejam dentro de limites bem definidos (valor máximo, valor mínimo, etc). Os requisitos de QoS devem ser atendidos pela rede, principalmente quando se trata de aplicações multimídia. Representam a quantidade de recursos específicos como memória, cpu, dispositivos de áudio e vídeo, etc, disponíveis no sistema, que devem ser alocados para as aplicações multimídia. Estes parâmetros de QoS especificam a quantidade de recursos a serem alocados para uma determinada aplicação, podendo quantificar o nível do serviço que está sendo oferecido pelo sistema para estas aplicações.

As soluções com esse fim incluem segregar o tráfego em links individuais ou usar mecanismos de QoS para designar níveis de largura de banda variáveis para cada aplicação, dentro de um link. Estes fluxos de dados possuem restrições que devem ser respeitadas tanto no trâmite pela rede quanto no sistema final, oferecendo assim, um certo nível de qualidade para o usuário. Neste contexto aplica-se o conceito de QoS onde o nível de serviço oferecido a uma aplicação multimídia pode ser medido e ou garantido através de seus parâmetros de QoS.

Para as aplicações multimídia é desejável que a rede que está transportando o fluxo gerado possa garantir, de alguma forma, o QoS especificado pela mesma. Mesmo quando um link tem a largura de banda adequada e esta banda está corretamente designada para atender as necessidades de cada aplicação, a latência (retardo) interfere na performance da rede, afetando em particular o tempo de resposta das aplicações.

Os parâmetros de QoS relativos as aplicações multimídia, como largura de banda, latência e outros, são incluídos na MIB/SNMP (Management Information Base/Simple Network Management Protocol) e dessa forma, pode-se ter um controle e monitoramento das aplicações localmente e no caso de aplicações multimídia distribuído remotamente, como por exemplo, aplicação de videoconferência, tele-medicina, entre outros.

### Métricas de QoS

As métricas de QoS são usadas para caracterizar e descrever o comportamento da rede no que diz respeito a sua utilização e performance, podendo ser definidas por um número específico de parâmetros que deverão ser cumpridos para a implementação da rede de computadores, principalmente quando envolverem o tráfego de informações através de redes mais amplas, como a Internet.

Um destes parâmetros envolve a possibilidade de medição dos serviços disponíveis na rede. A existência de uma boa infra-estrutura de medição é sempre importante, principalmente durante o período inicial de implementação de novos serviços. Através de ferramentas de medição e métricas de QoS bem definidas pode-se monitorar a performance garantida na alocação de recursos da rede.

Os resultados das principais métricas de QoS, fornecidas pela aplicação sob a forma de tabelas, gráficos e de uma visualização on-line, tornam possível reajustar e corrigir os valores de parametrização dos diversos mecanismos e melhorar o desempenho global da rede. Devido ao significado e definição próprio de cada métrica, a seleção das métricas mais adequadas para um estudo de performance em redes depende de vários fatores, tais como:

Objetivos específicos do estudo de performance;

Características da topologia que é objeto de estudo;

Os protocolos e serviços operados nesta topologia.

Alguns dos indicadores mais significativos para o estudo de performance em redes com aplicações multimídia estão relacionados na tabela seguinte.

![[Untitled 63.png|Untitled 63.png]]

Configurando uma QoS Básica com Roteadores CISCO Utilizando protocolo EIGRP.

### Antes de começar, um ponto fundamental é conseguir planejar e identificar as reais necessidades de implementação de políticas QoS. Para isso, três passos são fundamentais:

1. Identificar o tráfego e suas necessidades.

2. Dividir o tráfego em classes.

3. Definir a política QoS para cada classe.

**Política de QoS**

A Política de QoS define regras que organizam o tráfego conforme a necessidade do uso da banda passante, podendo vigorar em níveis de prioridade, reserva de banda e pré-roteamento. Ela é fundamental para um rendimento eficaz e produtivo do controle de entrada e saída do tráfego. Através dela, amplia-se a visão relacional, facilita e otimiza todo controle de banda. Nos casos de média ou alta complexidade é interessante elaborar documentos definindo todo o escopo da Política de QoS, inclusive a topologia de rede.

[![](https://img.uninove.br/static/0/0/0/0/0/0/0/3/1/1/3/311302/19831.png)](https://img.uninove.br/static/0/0/0/0/0/0/0/3/1/1/3/311302/19831.png)

O cenário que foi construído no Packet Tracer®. O modelo do roteador a ser utilizado é o 1841. Foi adicionado um módulo WIC-2T (duas portas seriais em cada roteador). O cabo serial é o tipo DTE. E nos PCs cabos Cross-Over.

**Comando Usados nos Roteadores (CLI)**

`1.` `1° Router Qos (CLI)` `2.` `Router>enable` `3.` `Router\#configure terminal` `4.` `Router(config)\#hostname QoS_Router` `5.` `QoS_Router(config)\#ip ssh version 1` `6.` `QoS_Router(config)\#spanning-tree mode pvst` `7.` `QoS_Router(config)\#class-map match-all critical` `8.` `QoS_Router(config-cmap)\#match protocol eigrp` `9.` `QoS_Router(config-cmap)\#exit` `10.` `QoS_Router(config)#class-map match-any interactive` `11.` `QoS_Router(config-cmap)#match protocol telnet` `12.` `QoS_Router(config-cmap)#match protocol ssh` `13.` `QoS_Router(config-cmap)#exit` `14.` `QoS_Router(config)#class-map match-any web` `15.` `QoS_Router(config-cmap)#match protocol http` `16.` `QoS_Router(config-cmap)#exit` `17.` `-->Bloco de definição da política para cada classe` `18.` `QoS_Router(config)\#policy-map markingpolicy` `19.` `QoS_Router(config-pmap)#class critical` `20.` `QoS_Router(config-pmap-c)\#set precedence 7` `21.` `QoS_Router(config-pmap-c)#exit` `22.` `QoS_Router(config-pmap)#class interactive` `23.` `QoS_Router(config-pmap-c)#set precedence 5` `24.` `QoS_Router(config-pmap-c)#exit` `25.` `QoS_Router(config-pmap)#class web` `26.` `QoS_Router(config-pmap-c)#set precedence 3` `27.` `QoS_Router(config-pmap-c)#exit` `28.` `QoS_Router(config-pmap)#exit` `29.` `-->Bloco de definição das interfaces` `30.`   `31.` `QoS_Router(config)\#interface loopback0` `32.` `QoS_Router(config-if)#ip add 10.0.0.1 255.255.255.255` `33.` `QoS_Router(config-if)#exit` `34.` `QoS_Router(config)#interface fastEthernet 0/0` `35.` `QoS_Router(config-if)#ip add 10.1.1.1 255.255.255.0` `36.` `QoS_Router(config-if)\#duplex auto` `37.` `QoS_Router(config-if)\#speed auto` `38.` `QoS_Router(config-if)\#no shutdown` `39.` `QoS_Router(config-if)#exit` `40.` `QoS_Router(config)#interface serial 0/0/0` `41.` `QoS_Router(config-if)#ip add 172.16.12.1 255.255.255.0` `42.` `QoS_Router(config-if)\#tx-ring-limit 1` `43.` `QoS_Router(config-if)\#service-policy output markingpolicy` `44.` `QoS_Router(config-if)\#hold-queue 1 out` `45.` `QoS_Router(config-if)#no shutdown` `46.` `QoS_Router(config-if)#exit` `47.` `QoS_Router(config)\#router eigrp 1` `48.` `QoS_Router(config-router)\#network 172.16.0.0` `49.` `QoS_Router(config-router)#network 10.0.0.0` `50.` `QoS_Router(config-router)#no auto-summary` `51.` `QoS_Router(config-router)#exit` `52.` `QoS_Router(config)#exit` `53.` `QoS_Router#` `54.` `QoS_Router\#copy running-config startup-config` `55.` `Destination filename [startup-config]?` `56.` `Building configuration...` `57.` `[OK]` `58.` `2° Router R2 (CLI)` `59.` `Router>en` `60.` `Router#conf t` `61.` `Router(config)#hostname R2` `62.` `R2(config)#ip ssh version 1` `63.` `R2(config)#spanning-tree mode pvst` `64.` `R2(config)#interface loopback0` `65.` `R2(config-if)#ip add 10.0.0.2 255.255.255.255` `66.` `R2(config-if)#exit` `67.` `R2(config)#interface serial 0/0/0` `68.` `R2(config-if)#ip add 172.16.2.2 255.255.255.0` `69.` `R2(config-if)\#clock rate 800000` `70.` `R2(config-if)#no shutdown` `71.` `R2(config-if)#exit` `72.` `R2(config)#interface serial 0/0/1` `73.` `R2(config-if)#ip add 172.16.23.2 255.255.255.0` `74.` `R2(config-if)#no shutdown` `75.` `R2(config-if)#exit` `76.` `R2(config)#router eigrp 1` `77.` `R2(config-router)#network 172.16.0.0` `78.` `R2(config-router)#no auto-summary` `79.` `R2(config-router)#exit` `80.` `R2(config)#exit` `81.` `R2#` `82.` `3° Router R3 (CLI)` `83.` `Router>en` `84.` `Router#conf t` `85.` `Router(config)#hostname R3` `86.` `R3(config)#ip ssh version 1` `87.` `R3(config)#spanning-tree mode pvst` `88.` `R3(config)#interface loopback0` `89.` `R3(config-if)#ip add 10.0.0.3 255.255.255.255` `90.` `R3(config-if)#exit` `91.` `R3(config)#interface serial 0/0/1` `92.` `R3(config-if)#ip add 172.16.23.3 255.255.255.0` `93.` `R3(config-if)#no shutdown` `94.` `R3(config)#router eigrp 1` `95.` `R3(config-router)#network 172.16.0.0` `96.` `R3(config-router)#no auto-summary` `97.` `R3(config-router)#exit` `98.` `R3(config)#exit` `99.` `R3#`

`1.` `1° Router Qos (CLI)` `2.` `Router>enable` `3.` `Router\#configure terminal` `4.` `Router(config)\#hostname QoS_Router` `5.` `QoS_Router(config)\#ip ssh version 1` `6.` `QoS_Router(config)\#spanning-tree mode pvst` `7.` `QoS_Router(config)\#class-map match-all critical` `8.` `QoS_Router(config-cmap)\#match protocol eigrp` `9.` `QoS_Router(config-cmap)\#exit` `10.` `QoS_Router(config)#class-map match-any interactive` `11.` `QoS_Router(config-cmap)#match protocol telnet` `12.` `QoS_Router(config-cmap)#match protocol ssh` `13.` `QoS_Router(config-cmap)#exit` `14.` `QoS_Router(config)#class-map match-any web` `15.` `QoS_Router(config-cmap)#match protocol http` `16.` `QoS_Router(config-cmap)#exit` `17.` `-->Bloco de definição da política para cada classe` `18.` `QoS_Router(config)\#policy-map markingpolicy` `19.` `QoS_Router(config-pmap)#class critical` `20.` `QoS_Router(config-pmap-c)\#set precedence 7` `21.` `QoS_Router(config-pmap-c)#exit` `22.` `QoS_Router(config-pmap)#class interactive` `23.` `QoS_Router(config-pmap-c)#set precedence 5` `24.` `QoS_Router(config-pmap-c)#exit` `25.` `QoS_Router(config-pmap)#class web` `26.` `QoS_Router(config-pmap-c)#set precedence 3` `27.` `QoS_Router(config-pmap-c)#exit` `28.` `QoS_Router(config-pmap)#exit` `29.` `-->Bloco de definição das interfaces` `30.`   `31.` `QoS_Router(config)\#interface loopback0` `32.` `QoS_Router(config-if)#ip add 10.0.0.1 255.255.255.255` `33.` `QoS_Router(config-if)#exit` `34.` `QoS_Router(config)#interface fastEthernet 0/0` `35.` `QoS_Router(config-if)#ip add 10.1.1.1 255.255.255.0` `36.` `QoS_Router(config-if)\#duplex auto` `37.` `QoS_Router(config-if)\#speed auto` `38.` `QoS_Router(config-if)\#no shutdown` `39.` `QoS_Router(config-if)#exit` `40.` `QoS_Router(config)#interface serial 0/0/0` `41.` `QoS_Router(config-if)#ip add 172.16.12.1 255.255.255.0` `42.` `QoS_Router(config-if)\#tx-ring-limit 1` `43.` `QoS_Router(config-if)\#service-policy output markingpolicy` `44.` `QoS_Router(config-if)\#hold-queue 1 out` `45.` `QoS_Router(config-if)#no shutdown` `46.` `QoS_Router(config-if)#exit` `47.` `QoS_Router(config)\#router eigrp 1` `48.` `QoS_Router(config-router)\#network 172.16.0.0` `49.` `QoS_Router(config-router)#network 10.0.0.0` `50.` `QoS_Router(config-router)#no auto-summary` `51.` `QoS_Router(config-router)#exit` `52.` `QoS_Router(config)#exit` `53.` `QoS_Router#` `54.` `QoS_Router\#write` `55.` `Building configuration...` `56.` `[OK]` `57.` `2° Router R2 (CLI)` `58.` `Router>en` `59.` `Router#conf t` `60.` `Router(config)#hostname R2` `61.` `R2(config)#ip ssh version 1` `62.` `R2(config)#spanning-tree mode pvst` `63.` `R2(config)#interface loopback0` `64.` `R2(config-if)#ip add 10.0.0.2 255.255.255.255` `65.` `R2(config-if)#exit` `66.` `R2(config)#interface serial 0/0/0` `67.` `R2(config-if)#ip add 172.16.2.2 255.255.255.0` `68.` `R2(config-if)\#clock rate 800000` `69.` `R2(config-if)#no shutdown` `70.` `R2(config-if)#exit` `71.` `R2(config)#interface serial 0/0/1` `72.` `R2(config-if)#ip add 172.16.23.2 255.255.255.0` `73.` `R2(config-if)#no shutdown` `74.` `R2(config-if)#exit` `75.` `R2(config)#router eigrp 1` `76.` `R2(config-router)#network 172.16.0.0` `77.` `R2(config-router)#no auto-summary` `78.` `R2(config-router)#exit` `79.` `R2(config)#exit` `80.` `R2#` `81.` `3° Router R3 (CLI)` `82.` `Router>en` `83.` `Router#conf t` `84.` `Router(config)#hostname R3` `85.` `R3(config)#ip ssh version 1` `86.` `R3(config)#spanning-tree mode pvst` `87.` `R3(config)#interface loopback0` `88.` `R3(config-if)#ip add 10.0.0.3 255.255.255.255` `89.` `R3(config-if)#exit` `90.` `R3(config)#interface serial 0/0/1` `91.` `R3(config-if)#ip add 172.16.23.3 255.255.255.0` `92.` `R3(config-if)#no shutdown` `93.` `R3(config)#router eigrp 1` `94.` `R3(config-router)#network 172.16.0.0` `95.` `R3(config-router)#no auto-summary` `96.` `R3(config-router)#exit` `97.` `R3(config)#exit` `98.` `R3#`

### Explicação:

QoS envolve priorização de tráfego na rede, pode ser demarcado em uma interface de rede, um servidor ou roteador. É especialmente importante para novas aplicações no ambiente de internet, como VoIP, vídeo sob demandas e outros serviços. Algumas tecnologias intermediárias, como tecnologias Ethernet, não foram desenhados para suportar priorização de tráfego ou garantia de nível de performance, tornando, assim, a implementação de QoS para esses casos muito mais difícil do que no ambiente de internet.

Para configurar um ambiente QoS, é preciso entender, primeiramente, as correlações dos comandos MQC (Modular QoS CLI), ou seja, é a interface em que serão digitados os comandos QoS.

### Essa rede apresentou as seguintes características:

O roteador "QoS_Router" foi configurado para usar QoS para marcar o serviço de roteamento EIGRP e os tráfegos telnet, SSH e HTTP que existem na interface serial 0/0/0. A configuração do "policy-map" foi feita com IP precedence nos campos para: 7 (pacotes críticos EIGRP), 5 para pacotes "interactive" (telnet e SSH) e 3 para tráfego web (HTTP). Todos os outros tipos de tráfego foram marcados como grupo padrão.

Conclusão

Nas redes atuais a largura de banda é um assunto importante, principalmente se consideramos que o montante de dados que precisa ser transmitido vem crescendo exponencialmente. Por esse motivo as novas aplicações em rede precisam cada vez de mais largura de banda e a Qualidade de Serviço torna-se um fator importante para o suporte a estas aplicações.

Um projeto baseado em métricas de QoS auxilia os administradores de redes a manterem os níveis de serviço solicitados pelos usuários, além de representar uma economia quanto aos aspectos de operação e manutenção da própria rede. Entretanto, a diversidade das aplicações envolvidas torna difícil estabelecer um padrão de QoS.

Apesar da maioria das métricas de QoS estarem mais voltadas para as redes de dados, não basta assegurar que o tráfego de dados seja distribuído com a QoS desejada, é necessário que existam mecanismos no sistema que possam garantir que os dados sejam entregues e processados corretamente por todo o percurso dentro da rede.